#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Sun Feb 25 10:40:44 2018

@author: joyce
"""

from stats import *
from alpha import *
import pandas as pd
import numpy as np
"""
compute as a whole
"""
alpha  = stAlpha('2005-01-01','2017-12-31')

a = alpha.alpha1()
filename =  '..\\alpha\\data\\1.csv'
a.to_csv(filename)

a = alpha.alpha2()
filename =  '..\\alpha\\data\\2.csv'
a.to_csv(filename)

a = alpha.alpha3()
filename =  '..\\alpha\\data\\3.csv'
a.to_csv(filename)

a = alpha.alpha4()
filename =  '..\\alpha\\data\\4.csv'
a.to_csv(filename)

a = alpha.alpha5()
filename =  '..\\alpha\\data\\5.csv'
a.to_csv(filename)

a = alpha.alpha6()
filename =  '..\\alpha\\data\\6.csv'
a.to_csv(filename)

a = alpha.alpha7()
filename =  '..\\alpha\\data\\7.csv'
a.to_csv(filename)

a = alpha.alpha8()
filename =  '..\\alpha\\data\\8.csv'
a.to_csv(filename)

a = alpha.alpha9()
filename =  '..\\alpha\\data\\9.csv'
a.to_csv(filename)

a = alpha.alpha10()
filename =  '..\\alpha\\data\\10.csv'
a.to_csv(filename)

a = alpha.alpha11()
filename =  '..\\alpha\\data\\11.csv'
a.to_csv(filename)

a = alpha.alpha12()
filename =  '..\\alpha\\data\\12.csv'
a.to_csv(filename)

a = alpha.alpha13()
filename =  '..\\alpha\\data\\13.csv'
a.to_csv(filename)

a = alpha.alpha14()
filename =  '..\\alpha\\data\\14.csv'
a.to_csv(filename)

a = alpha.alpha15()
filename =  '..\\alpha\\data\\15.csv'
a.to_csv(filename)

a = alpha.alpha16()
filename =  '..\\alpha\\data\\16.csv'
a.to_csv(filename)

a = alpha.alpha17()
filename =  '..\\alpha\\data\\17.csv'
a.to_csv(filename)

a = alpha.alpha18()
filename =  '..\\alpha\\data\\18.csv'
a.to_csv(filename)

a = alpha.alpha19()
filename =  '..\\alpha\\data\\19.csv'
a.to_csv(filename)

a = alpha.alpha20()
filename =  '..\\alpha\\data\\20.csv'
a.to_csv(filename)

"""
something wrong:RegBeta function
"""
#a = alpha.alpha21()
#filename =  '..\\alpha\\data\\21.csv'
#a.to_csv(filename)

a = alpha.alpha22()
filename =  '..\\alpha\\data\\22.csv'
a.to_csv(filename)

a = alpha.alpha23()
filename =  '..\\alpha\\data\\23.csv'
a.to_csv(filename)

a = alpha.alpha24()
filename =  '..\\alpha\\data\\24.csv'
a.to_csv(filename)

a = alpha.alpha26()
filename =  '..\\alpha\\data\\26.csv'
a.to_csv(filename)

a = alpha.alpha28()
filename =  '..\\alpha\\data\\28.csv'
a.to_csv(filename)

a = alpha.alpha29()
filename =  '..\\alpha\\data\\29.csv'
a.to_csv(filename)

"""
alpha30 uncomplete
"""
a = alpha.alpha31()
filename =  '..\\alpha\\data\\31.csv'
a.to_csv(filename)

a = alpha.alpha32()
filename =  '..\\alpha\\data\\32.csv'
a.to_csv(filename)

a = alpha.alpha33()
filename =  '..\\alpha\\data\\33.csv'
a.to_csv(filename)

a = alpha.alpha34()
filename =  '..\\alpha\\data\\34.csv'
a.to_csv(filename)

a = alpha.alpha36()
filename =  '..\\alpha\\data\\36.csv'
a.to_csv(filename)

a = alpha.alpha37()
filename =  '..\\alpha\\data\\37.csv'
a.to_csv(filename)

a = alpha.alpha38()
filename =  '..\\alpha\\data\\38.csv'
a.to_csv(filename)

a = alpha.alpha40()
filename =  '..\\alpha\\data\\40.csv'
a.to_csv(filename)

a = alpha.alpha41()
filename =  '..\\alpha\\data\\41.csv'
a.to_csv(filename)

a = alpha.alpha42()
filename =  '..\\alpha\\data\\42.csv'
a.to_csv(filename)

a = alpha.alpha43()
filename =  '..\\alpha\\data\\43.csv'
a.to_csv(filename)

a = alpha.alpha45()
filename =  '..\\alpha\\data\\45.csv'
a.to_csv(filename)

a = alpha.alpha46()
filename =  '..\\alpha\\data\\46.csv'
a.to_csv(filename)

a = alpha.alpha47()
filename =  '..\\alpha\\data\\47.csv'
a.to_csv(filename)

a = alpha.alpha48()
filename =  '..\\alpha\\data\\48.csv'
a.to_csv(filename)

a = alpha.alpha49()
filename =  '..\\alpha\\data\\49.csv'
a.to_csv(filename)

a = alpha.alpha50()
filename =  '..\\alpha\\data\\50.csv'
a.to_csv(filename)

a = alpha.alpha51()
filename =  '..\\alpha\\data\\51.csv'
a.to_csv(filename)

a = alpha.alpha52()
filename =  '..\\alpha\\data\\52.csv'
a.to_csv(filename)

a = alpha.alpha53()
filename =  '..\\alpha\\data\\53.csv'
a.to_csv(filename)

a = alpha.alpha54()
filename =  '..\\alpha\\data\\54.csv'
a.to_csv(filename)

a = alpha.alpha55()
filename =  '..\\alpha\\data\\55.csv'
a.to_csv(filename)

a = alpha.alpha56()
filename =  '..\\alpha\\data\\56.csv'
a.to_csv(filename)

a = alpha.alpha57()
filename =  '..\\alpha\\data\\57.csv'
a.to_csv(filename)

a = alpha.alpha58()
filename =  '..\\alpha\\data\\58.csv'
a.to_csv(filename)

a = alpha.alpha59()
filename =  '..\\alpha\\data\\59.csv'
a.to_csv(filename)

a = alpha.alpha60()
filename =  '..\\alpha\\data\\60.csv'
a.to_csv(filename)

a = alpha.alpha62()
filename =  '..\\alpha\\data\\62.csv'
a.to_csv(filename)

a = alpha.alpha63()
filename =  '..\\alpha\\data\\63.csv'
a.to_csv(filename)

a = alpha.alpha65()
filename =  '..\\alpha\\data\\65.csv'
a.to_csv(filename)

a = alpha.alpha66()
filename =  '..\\alpha\\data\\66.csv'
a.to_csv(filename)

a = alpha.alpha67()
filename =  '..\\alpha\\data\\67.csv'
a.to_csv(filename)

a = alpha.alpha68()
filename =  '..\\alpha\\data\\68.csv'
a.to_csv(filename)

a = alpha.alpha69()
filename =  '..\\alpha\\data\\69.csv'
a.to_csv(filename)

a = alpha.alpha70()
filename =  '..\\alpha\\data\\70.csv'
a.to_csv(filename)

a = alpha.alpha71()
filename =  '..\\alpha\\data\\71.csv'
a.to_csv(filename)

a = alpha.alpha72()
filename =  '..\\alpha\\data\\72.csv'
a.to_csv(filename)

a = alpha.alpha74()
filename =  '..\\alpha\\data\\74.csv'
a.to_csv(filename)

a = alpha.alpha75()
filename =  '..\\alpha\\data\\75.csv'
a.to_csv(filename)

a = alpha.alpha76()
filename =  '..\\alpha\\data\\76.csv'
a.to_csv(filename)

a = alpha.alpha78()
filename =  '..\\alpha\\data\\78.csv'
a.to_csv(filename)

a = alpha.alpha79()
filename =  '..\\alpha\\data\\79.csv'
a.to_csv(filename)

a = alpha.alpha80()
filename =  '..\\alpha\\data\\80.csv'
a.to_csv(filename)

a = alpha.alpha81()
filename =  '..\\alpha\\data\\81.csv'
a.to_csv(filename)

a = alpha.alpha82()
filename =  '..\\alpha\\data\\82.csv'
a.to_csv(filename)

a = alpha.alpha83()
filename =  '..\\alpha\\data\\83.csv'
a.to_csv(filename)

a = alpha.alpha84()
filename =  '..\\alpha\\data\\84.csv'
a.to_csv(filename)

a = alpha.alpha85()
filename =  '..\\alpha\\data\\85.csv'
a.to_csv(filename)

a = alpha.alpha86()
filename =  '..\\alpha\\data\\86.csv'
a.to_csv(filename)

a = alpha.alpha88()
filename =  '..\\alpha\\data\\88.csv'
a.to_csv(filename)

a = alpha.alpha89()
filename =  '..\\alpha\\data\\89.csv'
a.to_csv(filename)

a = alpha.alpha90()
filename =  '..\\alpha\\data\\90.csv'
a.to_csv(filename)

a = alpha.alpha91()
filename =  '..\\alpha\\data\\91.csv'
a.to_csv(filename)

a = alpha.alpha93()
filename =  '..\\alpha\\data\\93.csv'
a.to_csv(filename)

a = alpha.alpha94()
filename =  '..\\alpha\\data\\94.csv'
a.to_csv(filename)

a = alpha.alpha95()
filename =  '..\\alpha\\data\\95.csv'
a.to_csv(filename)

a = alpha.alpha96()
filename =  '..\\alpha\\data\\96.csv'
a.to_csv(filename)

a = alpha.alpha97()
filename =  '..\\alpha\\data\\97.csv'
a.to_csv(filename)

a = alpha.alpha98()
filename =  '..\\alpha\\data\\98.csv'
a.to_csv(filename)

a = alpha.alpha99()
filename =  '..\\alpha\\data\\99.csv'
a.to_csv(filename)

a = alpha.alpha100()
filename =  '..\\alpha\\data\\100.csv'
a.to_csv(filename)

a = alpha.alpha101()
filename =  '..\\alpha\\data\\101.csv'
a.to_csv(filename)

a = alpha.alpha102()
filename =  '..\\alpha\\data\\102.csv'
a.to_csv(filename)

a = alpha.alpha103()
filename =  '..\\alpha\\data\\103.csv'
a.to_csv(filename)

a = alpha.alpha104()
filename =  '..\\alpha\\data\\104.csv'
a.to_csv(filename)

a = alpha.alpha105()
filename =  '..\\alpha\\data\\105.csv'
a.to_csv(filename)

a = alpha.alpha106()
filename =  '..\\alpha\\data\\106.csv'
a.to_csv(filename)

a = alpha.alpha107()
filename =  '..\\alpha\\data\\107.csv'
a.to_csv(filename)

a = alpha.alpha108()
filename =  '..\\alpha\\data\\108.csv'
a.to_csv(filename)

a = alpha.alpha109()
filename =  '..\\alpha\\data\\109.csv'
a.to_csv(filename)

a = alpha.alpha110()
filename =  '..\\alpha\\data\\110.csv'
a.to_csv(filename)

a = alpha.alpha111()
filename =  '..\\alpha\\data\\111.csv'
a.to_csv(filename)

a = alpha.alpha112()
filename =  '..\\alpha\\data\\112.csv'
a.to_csv(filename)

a = alpha.alpha113()
filename =  '..\\alpha\\data\\113.csv'
a.to_csv(filename)

a = alpha.alpha114()
filename =  '..\\alpha\\data\\114.csv'
a.to_csv(filename)

a = alpha.alpha115()
filename =  '..\\alpha\\data\\115.csv'
a.to_csv(filename)

# something wrong,alpha116,RegResi funciton
#a = alpha.alpha116()
#filename =  '..\\alpha\\data\\116.csv'
#a.to_csv(filename)

a = alpha.alpha117()
filename =  '..\\alpha\\data\\117.csv'
a.to_csv(filename)

a = alpha.alpha118()
filename =  '..\\alpha\\data\\118.csv'
a.to_csv(filename)

a = alpha.alpha120()
filename =  '..\\alpha\\data\\120.csv'
a.to_csv(filename)

a = alpha.alpha121()
filename =  '..\\alpha\\data\\121.csv'
a.to_csv(filename)

a = alpha.alpha122()
filename =  '..\\alpha\\data\\122.csv'
a.to_csv(filename)

a = alpha.alpha123()
filename =  '..\\alpha\\data\\123.csv'
a.to_csv(filename)

a = alpha.alpha126()
filename =  '..\\alpha\\data\\126.csv'
a.to_csv(filename)

a = alpha.alpha127()
filename =  '..\\alpha\\data\\127.csv'
a.to_csv(filename)

a = alpha.alpha128()
filename =  '..\\alpha\\data\\128.csv'
a.to_csv(filename)

a = alpha.alpha129()
filename =  '..\\alpha\\data\\129.csv'
a.to_csv(filename)

a = alpha.alpha131()
filename =  '..\\alpha\\data\\131.csv'
a.to_csv(filename)

a = alpha.alpha132()
filename =  '..\\alpha\\data\\132.csv'
a.to_csv(filename)

a = alpha.alpha133()
filename =  '..\\alpha\\data\\133.csv'
a.to_csv(filename)

a = alpha.alpha134()
filename =  '..\\alpha\\data\\134.csv'
a.to_csv(filename)

a = alpha.alpha135()
filename =  '..\\alpha\\data\\135.csv'
a.to_csv(filename)

a = alpha.alpha136()
filename =  '..\\alpha\\data\\136.csv'
a.to_csv(filename)

a = alpha.alpha137()
filename =  '..\\alpha\\data\\137.csv'
a.to_csv(filename)

a = alpha.alpha139()
filename =  '..\\alpha\\data\\139.csv'
a.to_csv(filename)

a = alpha.alpha141()
filename =  '..\\alpha\\data\\141.csv'
a.to_csv(filename)

a = alpha.alpha142()
filename =  '..\\alpha\\data\\142.csv'
a.to_csv(filename)

a = alpha.alpha143()
filename =  '..\\alpha\\data\\143.csv'
a.to_csv(filename)

a = alpha.alpha144()
filename =  '..\\alpha\\data\\144.csv'
a.to_csv(filename)

a = alpha.alpha145()
filename =  '..\\alpha\\data\\145.csv'
a.to_csv(filename)

a = alpha.alpha146()
filename =  '..\\alpha\\data\\146.csv'
a.to_csv(filename)

"""
alpha147,RegBeta function
"""
#a = alpha.alpha147()
#filename =  '..\\alpha\\data\\147.csv'
#a.to_csv(filename)

a = alpha.alpha148()
filename =  '..\\alpha\\data\\148.csv'
a.to_csv(filename)

"""
something wrong with alpha149: RegBeta
"""
#a = alpha.alpha149()
#filename =  '..\\alpha\\data\\149.csv'
#a.to_csv(filename)

a = alpha.alpha150()
filename =  '..\\alpha\\data\\150.csv'
a.to_csv(filename)

a = alpha.alpha151()
filename =  '..\\alpha\\data\\151.csv'
a.to_csv(filename)

a = alpha.alpha152()
filename =  '..\\alpha\\data\\152.csv'
a.to_csv(filename)

a = alpha.alpha153()
filename =  '..\\alpha\\data\\153.csv'
a.to_csv(filename)

a = alpha.alpha154()
filename =  '..\\alpha\\data\\154.csv'
a.to_csv(filename)

a = alpha.alpha155()
filename =  '..\\alpha\\data\\155.csv'
a.to_csv(filename)

a = alpha.alpha157()
filename =  '..\\alpha\\data\\157.csv'
a.to_csv(filename)

a = alpha.alpha158()
filename =  '..\\alpha\\data\\158.csv'
a.to_csv(filename)

a = alpha.alpha159()
filename =  '..\\alpha\\data\\159.csv'
a.to_csv(filename)

a = alpha.alpha160()
filename =  '..\\alpha\\data\\160.csv'
a.to_csv(filename)

a = alpha.alpha161()
filename =  '..\\alpha\\data\\161.csv'
a.to_csv(filename)

a = alpha.alpha162()
filename =  '..\\alpha\\data\\162.csv'
a.to_csv(filename)

a = alpha.alpha163()
filename =  '..\\alpha\\data\\163.csv'
a.to_csv(filename)

a = alpha.alpha164()
filename =  '..\\alpha\\data\\164.csv'
a.to_csv(filename)

a = alpha.alpha165()
filename =  '..\\alpha\\data\\165.csv'
a.to_csv(filename)

a = alpha.alpha166()
filename =  '..\\alpha\\data\\166.csv'
a.to_csv(filename)

a = alpha.alpha167()
filename =  '..\\alpha\\data\\167.csv'
a.to_csv(filename)

a = alpha.alpha168()
filename =  '..\\alpha\\data\\168.csv'
a.to_csv(filename)

a = alpha.alpha169()
filename =  '..\\alpha\\data\\169.csv'
a.to_csv(filename)

a = alpha.alpha170()
filename =  '..\\alpha\\data\\170.csv'
a.to_csv(filename)

a = alpha.alpha171()
filename =  '..\\alpha\\data\\171.csv'
a.to_csv(filename)

a = alpha.alpha172()
filename =  '..\\alpha\\data\\172.csv'
a.to_csv(filename)

a = alpha.alpha173()
filename =  '..\\alpha\\data\\173.csv'
a.to_csv(filename)

a = alpha.alpha174()
filename =  '..\\alpha\\data\\174.csv'
a.to_csv(filename)

a = alpha.alpha175()
filename =  '..\\alpha\\data\\175.csv'
a.to_csv(filename)

a = alpha.alpha176()
filename =  '..\\alpha\\data\\176.csv'
a.to_csv(filename)

a = alpha.alpha177()
filename =  '..\\alpha\\data\\177.csv'
a.to_csv(filename)

a = alpha.alpha178()
filename =  '..\\alpha\\data\\178.csv'
a.to_csv(filename)

a = alpha.alpha179()
filename =  '..\\alpha\\data\\179.csv'
a.to_csv(filename)

a = alpha.alpha180()
filename =  '..\\alpha\\data\\180.csv'
a.to_csv(filename)

a = alpha.alpha181()
filename =  '..\\alpha\\data\\181.csv'
a.to_csv(filename)

a = alpha.alpha182()
filename =  '..\\alpha\\data\\182.csv'
a.to_csv(filename)

a = alpha.alpha183()
filename =  '..\\alpha\\data\\183.csv'
a.to_csv(filename)

a = alpha.alpha184()
filename =  '..\\alpha\\data\\184.csv'
a.to_csv(filename)

a = alpha.alpha185()
filename =  '..\\alpha\\data\\185.csv'
a.to_csv(filename)

a = alpha.alpha186()
filename =  '..\\alpha\\data\\186.csv'
a.to_csv(filename)

a = alpha.alpha187()
filename =  '..\\alpha\\data\\187.csv'
a.to_csv(filename)

a = alpha.alpha188()
filename =  '..\\alpha\\data\\188.csv'
a.to_csv(filename)

a = alpha.alpha189()
filename =  '..\\alpha\\data\\189.csv'
a.to_csv(filename)

a = alpha.alpha190()
filename =  '..\\alpha\\data\\190.csv'
a.to_csv(filename)

a = alpha.alpha191()
filename =  '..\\alpha\\data\\191.csv'
a.to_csv(filename)

"""
with the function of DecayLinear, compute as a part
"""

begin = ['2005-01-01','2006-10-01','2008-10-01','2010-10-01','2012-10-01','2014-10-01','2016-10-01']
end = ['2007-12-31','2009-12-31','2011-12-31','2013-12-31','2015-12-31','2017-12-31','2017-12-31']
for i in range(len(begin)):
    alpha = stAlpha(begin[i],end[i])
    
    # alpha25, backward 13 months
    a = alpha.alpha25()
    filename =  '..\\alpha\\data_temp\\25_' + str(i) + '.csv'
    a.to_csv(filename)

    # alpha27, backward 2 months
    a = alpha.alpha27()
    filename =  '..\\alpha\\data_temp\\27_' + str(i) + '.csv'
    a.to_csv(filename)    
    
    # alpha35 backward 1 months
    a = alpha.alpha35()
    filename =  '..\\alpha\\data_temp\\35_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha39 backward 8 months
    a = alpha.alpha39()
    filename =  '..\\alpha\\data_temp\\39_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha44 backward 1 months
    a = alpha.alpha44()
    filename =  '..\\alpha\\data_temp\\44_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha61，backward 4 months
    a = alpha.alpha61()
    filename =  '..\\alpha\\data_temp\\61_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha64，backward 4 months
    a = alpha.alpha64()
    filename =  '..\\alpha\\data_temp\\64_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha73，backward 2 months
    a = alpha.alpha73()
    filename =  '..\\alpha\\data_temp\\73_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha77，backward 3 months
    a = alpha.alpha77()
    filename =  '..\\alpha\\data_temp\\77_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha87, backward 1 months
    a = alpha.alpha87()
    filename =  '..\\alpha\\data_temp\\87_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha92,backward 8 months
    a = alpha.alpha92()
    filename =  '..\\alpha\\data_temp\\92_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha119, backward 3 months
    a = alpha.alpha119()
    filename =  '..\\alpha\\data_temp\\119_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha124, backward 2 months
    a = alpha.alpha124()
    filename =  '..\\alpha\\data_temp\\124_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha125, backward 6 months
    a = alpha.alpha125()
    filename =  '..\\alpha\\data_temp\\125_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha130, backward 3 months
    a = alpha.alpha130()
    filename =  '..\\alpha\\data_temp\\130_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha138, backward 5 months
    a = alpha.alpha138()
    filename =  '..\\alpha\\data_temp\\138_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha140, backward 5 months
    a = alpha.alpha140()
    filename =  '..\\alpha\\data_temp\\140_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha149,function of RegBeta,252
    a = alpha.alpha149()
    filename =  '..\\alpha\\data_temp\\149_' + str(i) + '.csv'
    a.to_csv(filename)    
    
    # alpha156, backward 1 months
    a = alpha.alpha156()
    filename =  '..\\alpha\\data_temp\\156_' + str(i) + '.csv'
    a.to_csv(filename)

"""
combine the parts as whole
"""

name_list = [25,27,35,39,44,61,64,73,77,87,92,119,124,125,130,138,140,156]
for i in range(len(name_list)):
    a = pd.DataFrame([])
    for j in range(len(begin)):
        filename = '..\\alpha\\data_temp\\' + str(i) \
                    + '_' + str(j) + '.csv'
        temp = pd.read_csv(filename)
        a = pd.concat([a,temp], axis = 0)
    a = a.drop_duplicates()
    alpha_name = 'alpha' + str(name_list[i])
    a.columns = ['date','secID',alpha_name]    
    filename1 = '..\\alpha\\data\\' + str(i) + '.csv'
    a.csv(filename1)

"""
with the function of Regress, compute as a part
"""      
begin = ['2005-01-01','2006-10-01','2007-10-01','2008-10-01','2009-10-01','2010-10-01',\
         '2011-10-01','2012-10-01','2013-10-01','2014-10-01','2015-10-01','2016-10-01']
end = ['2006-12-31','2007-12-31','2008-12-31','2009-12-31','2010-12-31','2011-12-31'\
       ,'2012-12-31','2013-12-31','2014-12-31','2015-12-31','2016-12-31','2017-12-31']
for i in range(len(begin)):
    alpha = stAlpha(begin[i],end[i])
    
    # alpha21, backward 1 month
    a = alpha.alpha21()
    filename = '..\\alpha\\data_temp\\21_' + str(i) + '.csv'
    a.to_csv(filename)
    
    # alpha116,backward 2 month
    a = alpha.alpha116()
    filename = '..\\alpha\\data_temp\\116_' + str(i) + '.csv'
    a.to_csv(filename)    
    
    # alpha147,backward 1 month
    a = alpha.alpha147()
    filename = '..\\alpha\\data_temp\\147_' + str(i) + '.csv'
    a.to_csv(filename)      

"""
combine the parts as whole
"""

name_list = [21,116,147]
for i in range(len(name_list)):
    a = pd.DataFrame([])
    for j in range(len(begin)):
        filename = '..\\alpha\\data_temp\\' + str(i) \
                    + '_' + str(j) + '.csv'
        temp = pd.read_csv(filename)
        a = pd.concat([a,temp], axis = 0)
    a = a.drop_duplicates()
    alpha_name = 'alpha' + str(name_list[i])
    a.columns = ['date','secID',alpha_name]
    filename1 = '..\\alpha\\data\\' + str(i) + '.csv'
    a.csv(filename1)